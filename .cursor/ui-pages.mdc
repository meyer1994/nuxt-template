---
globs: app/pages/**/*.vue,app/app.vue
alwaysApply: false
---

## Data Fetching

The data of the app SHOULD be fetched at the page level and passed down to 
child components.

The child components SHOULD NOT make API calls or fetch data themselves, but 
instead define and use `emits` to communicate changes back to the parent page.

## Good example

```vue
<script setup lang="ts">
const { $trpc } = useNuxtApp()
const { data, refresh } = await $trpc.users.list.query()
</script>

<template>
<div>
  <p> {{ data?.length }} users</p>
  <TableAdminUsers
    :items="data || []"
    @delete="async (id) => {
      await $trpc.users.delete.mutate({ id })
      refresh()
    }"
  />
</div>
</template>
```

## Bad example

```vue
<script setup lang="ts">
const { $trpc } = useNuxtApp()
const { data, refresh } = await $trpc.users.list.query()
</script>

<template>
  <div>
    <p> {{ data?.length }} users</p>
    <!-- Call the API to delete the user -->
    <TableAdminUsers :items="data || []" />
  </div>
</template>
```
